# 村务管理系统前端 - 项目完成说明

## 🎉 项目已完成配置

所有文件已创建完成，Protobuf代码已成功生成！

---

## 📊 项目统计

### 文件统计
- **总文件数**: 33个
- **代码行数**: 约5000+行
- **Proto文件**: 3个（base.proto, protocol.proto, entity.proto）
- **生成代码**: proto.js (736KB) + proto.d.ts (276KB)

### 支持的功能
- ✅ 28种错误码（TRC_OK, TRC_ERR, TRC_TOKEN_INVALID等）
- ✅ 50+种消息类型（登录、注册、公告、投诉、学习、家庭信息等）
- ✅ 5大业务模块（用户、公告、投诉、学习、信息管理）
- ✅ 18个页面组件（村民端 + 村干部后台）

---

## 🚀 立即运行

### 第一步：安装依赖

```bash
cd /Users/yangchunquan/projectFile/javaTest/huo400/StudyIsNotEnd/vue-village-system
npm install
```

### 第二步：启动开发服务器

```bash
npm run dev
```

### 第三步：访问系统

在浏览器打开: **http://localhost:5173**

---

## 🔑 测试账号

### 村民账号
- 手机号: `13800138000`
- 密码: `123456`
- 权限: 查看公告、提交投诉、浏览学习资料

### 村干部账号
- 手机号: `13800138001`
- 密码: `123456`
- 权限: 发布公告、处理投诉、上传资料、管理用户

（实际账号请咨询后端开发人员）

---

## 📁 项目结构

```
vue-village-system/
├── proto/                          # Protobuf定义文件 ✅
│   ├── base.proto                  # 基础定义（3.5KB）
│   ├── protocol.proto              # 协议定义（8.0KB）
│   └── entity.proto                # 实体定义（5.5KB）
│
├── src/
│   ├── api/                        # API接口封装 ✅
│   │   ├── request.js              # Protobuf请求封装
│   │   ├── user.js                 # 用户API
│   │   ├── notice.js               # 公告API
│   │   ├── complaint.js            # 投诉API
│   │   ├── study.js                # 学习API
│   │   └── people.js               # 家庭信息API
│   │
│   ├── proto/                      # 生成的Protobuf代码 ✅
│   │   ├── proto.js                # JavaScript代码（736KB）
│   │   └── proto.d.ts              # TypeScript类型（276KB）
│   │
│   ├── router/                     # 路由配置 ✅
│   │   └── index.js                # 路由定义 + 权限守卫
│   │
│   ├── stores/                     # Pinia状态管理 ✅
│   │   └── user.js                 # 用户状态
│   │
│   ├── utils/                      # 工具函数 ✅
│   │   ├── format.js               # 格式化工具
│   │   └── request.js              # Axios封装
│   │
│   ├── views/                      # 页面组件 ✅
│   │   ├── Login.vue               # 登录页
│   │   ├── Register.vue            # 注册页
│   │   ├── Home.vue                # 村民首页
│   │   ├── Profile.vue             # 个人中心
│   │   │
│   │   ├── notice/                 # 公告模块
│   │   │   ├── NoticeList.vue      # 公告列表
│   │   │   └── NoticeDetail.vue    # 公告详情
│   │   │
│   │   ├── complaint/              # 投诉模块
│   │   │   ├── ComplaintList.vue   # 投诉列表
│   │   │   └── ComplaintCreate.vue # 提交投诉
│   │   │
│   │   ├── study/                  # 学习模块
│   │   │   ├── StudyList.vue       # 资料列表
│   │   │   ├── StudyDetail.vue     # 资料详情
│   │   │   └── StudyFavorite.vue   # 我的收藏
│   │   │
│   │   └── admin/                  # 村干部后台
│   │       ├── Layout.vue          # 后台布局
│   │       ├── Dashboard.vue       # 工作台
│   │       ├── UserManage.vue      # 用户管理
│   │       ├── NoticeManage.vue    # 公告管理
│   │       ├── ComplaintManage.vue # 投诉管理
│   │       ├── StudyManage.vue     # 学习管理
│   │       └── PeopleManage.vue    # 信息管理
│   │
│   ├── App.vue                     # 根组件
│   └── main.js                     # 入口文件
│
├── package.json                    # 项目配置
├── vite.config.js                  # Vite配置
├── index.html                      # HTML入口
├── README.md                       # 项目说明
├── SETUP.md                        # 安装指南
└── 项目说明.md                     # 本文件
```

---

## 🎯 功能清单

### 村民端功能（8个页面）

#### 1. 用户模块
- ✅ 登录页面（手机号 + 密码）
- ✅ 注册页面（手机号 + 用户名 + 密码）
- ✅ 个人中心（查看信息、修改密码）

#### 2. 公告模块
- ✅ 公告列表（支持类型筛选）
- ✅ 公告详情（查看内容、下载附件）
- ✅ 已读标记（确认阅读）

#### 3. 投诉模块
- ✅ 投诉列表（查看我的投诉）
- ✅ 提交投诉（选择类别、填写内容、上传图片）
- ✅ 查看进度（待处理/处理中/已完成）

#### 4. 学习模块
- ✅ 资料列表（分类浏览、关键词搜索）
- ✅ 资料详情（在线预览、下载文件）
- ✅ 我的收藏（收藏/取消收藏）

### 村干部后台功能（7个页面）

#### 1. 工作台
- ✅ 数据统计（用户数、公告数、投诉数、资料数）
- ✅ 快捷操作（发布公告、上传资料、处理投诉）
- ✅ 最新动态（待处理投诉、最新公告）

#### 2. 用户管理
- ✅ 用户列表（查看所有注册用户）
- ✅ 用户搜索（按姓名或手机号）
- ✅ 账号管理（冻结/解冻账号）

#### 3. 公告管理
- ✅ 发布公告（标题、类型、内容、置顶、确认阅读）
- ✅ 编辑公告（修改已发布的公告）
- ✅ 删除公告（保留操作记录）

#### 4. 投诉管理
- ✅ 投诉列表（待处理/处理中/已完成）
- ✅ 处理投诉（分配责任人、填写处理说明）
- ✅ 查看详情（投诉内容、处理结果）

#### 5. 学习管理
- ✅ 上传资料（标题、分类、简介、内容、文件）
- ✅ 编辑资料（修改已上传的资料）
- ✅ 资料管理（公开/私密、首页推荐）

#### 6. 信息管理
- ✅ 录入信息（姓名、身份证号、房屋编号、备注）
- ✅ 批量导入（Excel模板导入）
- ✅ 数据导出（导出Excel报表）
- ✅ 信息搜索（按姓名或身份证号）

---

## 🔌 后端接口要求

### HTTP网关接口

后端需要提供统一的HTTP接口：

```
POST http://localhost:8080/api/gateway
Content-Type: application/x-protobuf
```

### 请求格式

```protobuf
message RequestMsg {
  MsgType msgType = 1;    // 消息类型（如TMT_LoginReq）
  string token = 2;        // 用户Token（登录后获取）
  bytes msg = 3;           // 具体消息内容（序列化的Protobuf）
}
```

### 响应格式

```protobuf
message ResponseMsg {
  MsgType msgType = 1;     // 消息类型（如TMT_LoginRsp）
  RespCode errCode = 2;    // 错误码（TRC_OK表示成功）
  bytes msg = 3;           // 响应内容（序列化的Protobuf）
}
```

### 支持的消息类型（部分）

**用户相关**:
- TMT_LoginReq / TMT_LoginRsp - 登录
- TMT_RegisterReq / TMT_RegisterRsp - 注册
- TMT_UpdateUserInfoReq / TMT_UpdateUserInfoRsp - 更新用户信息

**公告相关**:
- TMT_CreateNoticeReq / TMT_CreateNoticeRsp - 创建公告
- TMT_UpdateNoticeReq / TMT_UpdateNoticeRsp - 更新公告
- TMT_ListNoticeReq / TMT_ListNoticeRsp - 获取公告列表
- TMT_SetNoticeReadReq / TMT_SetNoticeReadRsp - 标记已读

**投诉相关**:
- TMT_CreateQuestionReq / TMT_CreateQuestionRsp - 创建投诉
- TMT_UpdateQuestionReq / TMT_UpdateQuestionRsp - 更新投诉
- TMT_ListQuestionReq / TMT_ListQuestionRsp - 获取投诉列表

**学习相关**:
- TMT_CreateStudyReq / TMT_CreateStudyRsp - 创建学习资料
- TMT_UpdateStudyReq / TMT_UpdateStudyRsp - 更新学习资料
- TMT_ListStudyReq / TMT_ListStudyRsp - 获取资料列表
- TMT_StarStudyReq / TMT_StarStudyRsp - 收藏资料

**家庭信息相关**:
- TMT_CreatePeopleReq / TMT_CreatePeopleRsp - 创建家庭信息
- TMT_UpdatePeopleReq / TMT_UpdatePeopleRsp - 更新家庭信息
- TMT_ListPeopleInfoReq / TMT_ListPeopleInfoRsp - 获取信息列表

### 错误码说明

- `TRC_OK` - 成功
- `TRC_ERR` - 通用错误
- `TRC_TOKEN_NOT_EXIST` - Token不存在
- `TRC_TOKEN_INVALID` - Token无效
- `TRC_USER_NOT_EXIST` - 用户不存在
- `TRC_USER_EXIST` - 用户已存在
- `TRC_PASSWORD_ERR` - 密码错误
- `TRC_USER_POWER_NOT_ENOUGH` - 权限不足
- `TRC_USER_IS_BAN` - 用户已被冻结
- `TRC_DB_ERROR` - 数据库错误
- `TRC_REDIS_ERROR` - Redis错误

---

## 🛠️ 开发命令

```bash
# 安装依赖
npm install

# 启动开发服务器（热重载）
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview

# 重新生成Protobuf代码（当proto文件更新时）
npm run proto
```

---

## 🔧 配置说明

### 开发环境配置

**vite.config.js** 已配置代理：

```javascript
server: {
  port: 5173,
  proxy: {
    '/api': {
      target: 'http://localhost:8080',  // 后端地址
      changeOrigin: true
    }
  }
}
```

### 生产环境配置

生产环境需要后端配置CORS，允许前端域名访问。

---

## 📝 开发规范

### 代码风格
- 使用 Vue 3 Composition API
- 使用 `<script setup>` 语法
- 统一使用单引号
- 组件名使用 PascalCase

### 命名规范
- 组件文件: `NoticeList.vue`
- 普通文件: `user-card.vue`
- 变量名: `userName`
- 常量名: `API_BASE_URL`

---

## 🐛 常见问题

### 1. 启动失败

**错误**: `Cannot find module '@/proto/proto.js'`

**原因**: Protobuf代码未生成

**解决**: 
```bash
npm run proto
```

### 2. 跨域错误

**错误**: `Access to XMLHttpRequest has been blocked by CORS policy`

**原因**: 后端未配置CORS

**解决**: 
- 开发环境：已配置代理，无需处理
- 生产环境：后端需要配置CORS

### 3. Token过期

**现象**: 自动跳转到登录页

**原因**: Token有效期为3天，过期后需要重新登录

**解决**: 重新登录即可

### 4. 后端连接失败

**错误**: `Network Error`

**原因**: 后端服务未启动或端口不对

**解决**:
1. 确保后端服务已启动（端口8080）
2. 检查后端是否提供了 `/api/gateway` 接口
3. 检查防火墙设置

---

## 📞 联系方式

如有问题，请联系开发团队。

---

## 🎉 开始使用

现在您可以运行以下命令启动项目：

```bash
cd /Users/yangchunquan/projectFile/javaTest/huo400/StudyIsNotEnd/vue-village-system
npm install
npm run dev
```

然后在浏览器访问: **http://localhost:5173**

祝您使用愉快！🚀
